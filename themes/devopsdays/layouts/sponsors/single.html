{{ define "main" }}
{{ $sponsors := .Site.Data.sponsors.sponsors }}
{{ $goldCount := 0 }}
{{ $silverCount := 0 }}
{{ $bronzeCount := 0 }}
{{ $eventCount := 0 }}

{{ range $sponsors }}
{{ if eq .level "gold" }}
{{ $goldCount = add $goldCount 1 }}
{{ else if eq .level "silver" }}
{{ $silverCount = add $silverCount 1 }}
{{ else if eq .level "bronze" }}
{{ $bronzeCount = add $bronzeCount 1 }}
{{ else if eq .level "event" }}
{{ $eventCount = add $eventCount 1 }}
{{ end }}
{{ end }}

{{ $goldMax := 5 }}
{{ $silverMax := 3 }}
{{ $eventMax := 3 }}

{{ $goldStatus := cond (ge $goldCount $goldMax) "SOLD OUT" "Available" }}
{{ $silverStatus := cond (ge $silverCount $silverMax) "SOLD OUT" "Available" }}
{{ $bronzeStatus := "Available" }}
{{ $eventStatus := cond (ge $eventCount $eventMax) "SOLD OUT" "Available" }}

<div class="py-8" style="background: linear-gradient(135deg, var(--cerulean), var(--indigo-dye));">
    <div class="container mx-auto px-4">
        {{ partial "breadcrumbs.html" . }}
        <h1 class="text-4xl font-bold text-white">{{ .Title }}</h1>
        {{ if .Description }}
        <p class="text-xl text-gray-100 mt-4">{{ .Description }}</p>
        {{ end }}
    </div>
</div>

<section class="py-12">
    <div class="container mx-auto px-4">
        <div class="prose prose-lg max-w-4xl mx-auto">
            {{ $content := .Content }}
            {{ $searchStr := print "| **Status** | **SOLD OUT** | **SOLD OUT** | **Available** | **SOLD OUT** | **Available** |" }}
            {{ $replaceStr := printf "| **Status** | **%s** | **%s** | **%s** | **%s** | **%s** |" $goldStatus $silverStatus $bronzeStatus $eventStatus $eventStatus }}
            {{ $content = replace $content $searchStr $replaceStr }}
            {{ $content | safeHTML }}
        </div>
    </div>
</section>
{{ end }}